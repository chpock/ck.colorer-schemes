  0: <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>pipeline</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
  1:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>agent</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
  2:         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>label</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>openstack-slave</span><span class='def-StringEdge def-String'>"</span>
  3:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
  4:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>environment</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
  5:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_VERSION</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>0.9.0-SNAPSHOT</span><span class='def-StringEdge def-String'>'</span>
  6:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_NAME</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>WSO2-TestGrid</span><span class='def-StringEdge def-String'>'</span>
  7:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_DIST_URL</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>https://wso2.org/jenkins/job/testgrid/job/testgrid/</span><span class='def-StringEdge def-String'>'</span> <span class='def-Symbol'>+</span>
  8:                 <span class='def-StringEdge def-String'>'</span><span class='def-String'>lastSuccessfulBuild/artifact/distribution/target/${TESTGRID_NAME}.zip</span><span class='def-StringEdge def-String'>'</span>
  9:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_DIST_LOCATION</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>/testgrid/jenkins-home/workspace</span><span class='def-StringEdge def-String'>'</span>
 10:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_HOME</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>/testgrid/testgrid-home</span><span class='def-StringEdge def-String'>'</span>
 11: 
 12:         <span class='jenkinsfile-Variable def-Var'>PRODUCT</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>wso2is-5.4.0-LTS-kubernetes</span><span class='def-StringEdge def-String'>"</span>
 13: 
 14:         <span class='jenkinsfile-Variable def-Var'>INFRASTRUCTURE_REPOSITORY</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>https://github.com/sameerawickramasekara/k8s-on-openstack</span><span class='def-StringEdge def-String'>'</span>
 15:         <span class='jenkinsfile-Variable def-Var'>DEPLOYMENT_REPOSITORY</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>https://github.com/azinneera/k8s-on-openstack</span><span class='def-StringEdge def-String'>'</span>
 16:         <span class='jenkinsfile-Variable def-Var'>SCENARIOS_REPOSITORY</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>https://github.com/wso2-incubator/identity-test-integration.git</span><span class='def-StringEdge def-String'>'</span>
 17: 
 18:         <span class='jenkinsfile-Variable def-Var'>INFRA_LOCATION</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>k8s-on-openstack</span><span class='def-StringEdge def-String'>"</span>
 19:         <span class='jenkinsfile-Variable def-Var'>DEPLOYMENT_LOCATION</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>k8s-on-openstack/deployment</span><span class='def-StringEdge def-String'>"</span>
 20:         <span class='jenkinsfile-Variable def-Var'>SCENARIOS_LOCATION</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>identity-test-integration</span><span class='def-StringEdge def-String'>"</span>
 21:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_YAML_FILE</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>is-pattern-1-infra.yaml</span><span class='def-StringEdge def-String'>'</span>
 22: 
 23:         <span class='jenkinsfile-Variable def-Var'>OS_REGION_NAME</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>RegionOne</span><span class='def-StringEdge def-String'>"</span>
 24:         <span class='jenkinsfile-Variable def-Var'>OS_TENANT_ID</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>credentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>OS_USERNAME</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 25:         <span class='jenkinsfile-Variable def-Var'>OS_PASSWORD</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>credentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>OS_PASSWORD</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 26:         <span class='jenkinsfile-Variable def-Var'>OS_AUTH_URL</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>http://203.94.95.131:5000/v2.0</span><span class='def-StringEdge def-String'>"</span>
 27:         <span class='jenkinsfile-Variable def-Var'>OS_USERNAME</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>credentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>OS_USERNAME</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 28:         <span class='jenkinsfile-Variable def-Var'>OS_TENANT_NAME</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>credentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>OS_USERNAME</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 29:         <span class='jenkinsfile-Variable def-Var'>TESTGRID_BOT_CREDENTIALS</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>credentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>TESTGRID_BOT_CREDENTIALS</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 30: 
 31:         <span class='jenkinsfile-Variable def-Var'>PWD</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>pwd</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
 32:         <span class='jenkinsfile-Variable def-Var'>JOB_CONFIG_YAML</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>job-config.yaml</span><span class='def-StringEdge def-String'>"</span>
 33:         <span class='jenkinsfile-Variable def-Var'>JOB_CONFIG_YAML_PATH</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${PWD}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML}</span><span class='def-StringEdge def-String'>"</span>
 34: 
 35:         <span class='jenkinsfile-Variable def-Var'>MYSQL_DRIVER_LOCATION</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>http://central.maven.org/maven2/mysql/mysql-connector-java/6.0.6/mysql-connector-java-6.0.6.jar</span><span class='def-StringEdge def-String'>'</span>
 36:         <span class='def-LineComment def-Comment def-Syntax'>// Jmeter dependencies</span>
 37:         <span class='jenkinsfile-Variable def-Var'>SELENIUM_JAR</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>https://search.maven.org/remotecontent?filepath=org/seleniumhq/selenium/selenium-java/3.8.1/selenium-java-3.8.1.jar</span><span class='def-StringEdge def-String'>'</span>
 38:         <span class='jenkinsfile-Variable def-Var'>HTML_UNIT_DRIVER</span><span class='jenkinsfile-Symbol def-Symbol'>=</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>https://search.maven.org/remotecontent?filepath=org/seleniumhq/selenium/htmlunit-driver/2.29.0/htmlunit-driver-2.29.0-jar-with-dependencies.jar</span><span class='def-StringEdge def-String'>'</span>
 39:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 40: 
 41:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>tools</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
 42:         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>jdk</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>jdk8</span><span class='def-StringEdge def-String'>'</span>
 43:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 44: 
 45:     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stages</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 46:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Preparation</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 47:             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 48: 
 49:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>echo</span> <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>pwd</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
 50:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>deleteDir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
 51: 
 52:                 <span class='def-LineComment def-Comment def-Syntax'>// Clone scenario repo</span>
 53:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mkdir </span><span class='def-VarStrong def-Var'>${SCENARIOS_LOCATION}</span><span class='def-StringEdge def-String'>"</span>
 54:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${SCENARIOS_LOCATION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>{</span>
 55:                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>git</span> url<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${SCENARIOS_REPOSITORY}</span><span class='def-StringEdge def-String'>"</span>
 56:                 <span class='def-SymbolStrong def-Symbol'>}</span>
 57: 
 58:                 <span class='def-LineComment def-Comment def-Syntax'>// Clone infra repo</span>
 59:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mkdir </span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-StringEdge def-String'>"</span>
 60:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>{</span>
 61:                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>git</span> url<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${INFRASTRUCTURE_REPOSITORY}</span><span class='def-StringEdge def-String'>"</span>
 62:                 <span class='def-SymbolStrong def-Symbol'>}</span>
 63: 
 64:                 <span class='def-LineComment def-Comment def-Syntax'>// Clone deployment repo</span>
 65:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mkdir </span><span class='def-VarStrong def-Var'>${DEPLOYMENT_LOCATION}</span><span class='def-StringEdge def-String'>"</span>
 66:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${DEPLOYMENT_LOCATION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>{</span>
 67:                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>git</span> branch<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>deployment</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span>
 68:                             url<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${DEPLOYMENT_REPOSITORY}</span><span class='def-StringEdge def-String'>"</span>
 69:                 <span class='def-SymbolStrong def-Symbol'>}</span>
 70: 
 71:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
 72: <span class='def-String'>                echo </span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'></span>
 73: <span class='def-String'></span>
 74: <span class='def-String'>                unzip </span><span class='def-VarStrong def-Var'>${TESTGRID_DIST_LOCATION}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'>.zip</span>
 75: <span class='def-String'>                cd </span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'></span>
 76: <span class='def-String'>                curl -o ./lib/mysql.jar </span><span class='def-VarStrong def-Var'>$MYSQL_DRIVER_LOCATION</span><span class='def-String'></span>
 77: <span class='def-String'>                curl -o ./lib/selenium-java.jar </span><span class='def-VarStrong def-Var'>$SELENIUM_JAR</span><span class='def-String'></span>
 78: <span class='def-String'>                curl -o ./lib/html-unit-driver.jar </span><span class='def-VarStrong def-Var'>$HTML_UNIT_DRIVER</span><span class='def-String'></span>
 79: <span class='def-String'>                </span><span class='def-StringEdge def-String'>"""</span>
 80: 
 81:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
 82: <span class='def-String'>                echo 'infrastructureRepository: </span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-String'>/cloudformation-templates/pattern-1/' > </span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML_PATH}</span><span class='def-String'></span>
 83: <span class='def-String'>                echo 'deploymentRepository: </span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-String'>/cloudformation-templates/pattern-1/' >> </span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML_PATH}</span><span class='def-String'></span>
 84: <span class='def-String'>                echo 'scenarioTestsRepository: </span><span class='def-VarStrong def-Var'>${SCENARIOS_LOCATION}</span><span class='def-String'>' >> </span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML_PATH}</span><span class='def-String'></span>
 85: <span class='def-String'>                echo 'testgridYamlLocation: </span><span class='def-VarStrong def-Var'>${TESTGRID_YAML_FILE}</span><span class='def-String'>' >> </span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML_PATH}</span><span class='def-String'></span>
 86: <span class='def-String'></span>
 87: <span class='def-String'>                echo The job-config.yaml:</span>
 88: <span class='def-String'>                cat </span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML_PATH}</span><span class='def-String'></span>
 89: <span class='def-String'>                </span><span class='def-StringEdge def-String'>"""</span>
 90: 
 91:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>stash</span> name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML}</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> includes <span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML}</span><span class='def-StringEdge def-String'>"</span>
 92: 
 93:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
 94: <span class='def-String'>                    cd </span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'></span>
 95: <span class='def-String'>                    ./testgrid generate-test-plan \</span>
 96: <span class='def-String'>                        --product </span><span class='def-VarStrong def-Var'>${PRODUCT}</span><span class='def-String'> \</span>
 97: <span class='def-String'>                        -tc </span><span class='def-VarStrong def-Var'>${INFRA_CONFIG_FILE}</span><span class='def-String'></span>
 98: <span class='def-String'>                    </span><span class='def-StringEdge def-String'>"""</span>
 99:             <span class='def-SymbolStrong def-Symbol'>}</span>
100:         <span class='def-SymbolStrong def-Symbol'>}</span>
101: 
102:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>TestPlan-01-Infra-1</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
103:             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
104:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
105:                     <span class='def-Keyword'>try</span> <span class='def-SymbolStrong def-Symbol'>{</span>
106:                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>echo</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>Running Test Plan 01</span><span class='def-StringEdge def-String'>'</span>
107:                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>java -version</span><span class='def-StringEdge def-String'>"</span>
108: 
109:                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>unstash</span> name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${JOB_CONFIG_YAML}</span><span class='def-StringEdge def-String'>"</span>
110: 
111:                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
112: <span class='def-String'>                            cd </span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'></span>
113: <span class='def-String'>                            ./testgrid run-testplan \</span>
114: <span class='def-String'>                                --product </span><span class='def-VarStrong def-Var'>${PRODUCT}</span><span class='def-String'> \</span>
115: <span class='def-String'>                                -ir </span><span class='def-VarStrong def-Var'>${PWD}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-String'> \</span>
116: <span class='def-String'>                                -dr </span><span class='def-VarStrong def-Var'>${PWD}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${INFRA_LOCATION}</span><span class='def-String'> \</span>
117: <span class='def-String'>                                -sr </span><span class='def-VarStrong def-Var'>${PWD}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${SCENARIOS_LOCATION}</span><span class='def-String'></span>
118: <span class='def-String'>                            </span><span class='def-StringEdge def-String'>"""</span>
119:                     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='def-Keyword'>catch</span> <span class='def-SymbolStrong def-Symbol'>(</span>Exception err<span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
120:                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>echo</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>Error : </span><span class='def-VarStrong def-Var'>${err}</span><span class='def-StringEdge def-String'>"</span>
121:                         currentBuild<span class='def-Symbol'>.</span>result <span class='def-Symbol'>=</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>FAILURE</span><span class='def-StringEdge def-String'>'</span>
122:                     <span class='def-SymbolStrong def-Symbol'>}</span>
123:                 <span class='def-SymbolStrong def-Symbol'>}</span>
124:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>echo</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>RESULT: </span><span class='def-VarStrong def-Var'>${currentBuild.result}</span><span class='def-StringEdge def-String'>"</span>
125:             <span class='def-SymbolStrong def-Symbol'>}</span>
126:         <span class='def-SymbolStrong def-Symbol'>}</span>
127:     <span class='def-SymbolStrong def-Symbol'>}</span>
128: 
129:     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>post</span> <span class='def-SymbolStrong def-Symbol'>{</span>
130:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>always</span> <span class='def-SymbolStrong def-Symbol'>{</span>
131:            <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
132: <span class='def-String'>            cd </span><span class='def-VarStrong def-Var'>${TESTGRID_NAME}</span><span class='def-String'></span>
133: <span class='def-String'>            ./testgrid generate-report \</span>
134: <span class='def-String'>            --product </span><span class='def-VarStrong def-Var'>${PRODUCT}</span><span class='def-String'> \</span>
135: <span class='def-String'>            --groupBy scenario</span>
136: <span class='def-String'>            </span><span class='def-StringEdge def-String'>"""</span>
137: 
138:             <span class='def-LineComment def-Comment def-Syntax'>// Archive artifacts</span>
139:             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>withAWS</span><span class='def-SymbolStrong def-Symbol'>(</span>region<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>us-east-1</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> credentials<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>TESTGRID_BOT_CREDENTIALS</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
140:                 <span class='def-LineComment def-Comment def-Syntax'>// Upload artifacts to S3</span>
141:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>s3Upload</span><span class='def-SymbolStrong def-Symbol'>(</span>workingDir<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${TESTGRID_HOME}</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> bucket<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>jenkins-testrun-artifacts</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> path<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>artifacts/audit.log</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> file<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>audit.log</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
142:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>s3Upload</span><span class='def-SymbolStrong def-Symbol'>(</span>workingDir<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${TESTGRID_HOME}</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> bucket<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>jenkins-testrun-artifacts</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> path<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>artifacts/testgrid.log</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> file<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>testgrid.log</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
143:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>s3Upload</span><span class='def-SymbolStrong def-Symbol'>(</span>workingDir<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${TESTGRID_HOME}</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> bucket<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>jenkins-testrun-artifacts</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> path<span class='def-Symbol'>:</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>artifacts/error.log</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> file<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>error.log</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
144:             <span class='def-SymbolStrong def-Symbol'>}</span>
145: 
146:             <span class='def-LineComment def-Comment def-Syntax'>// Delete logs and reports after upload</span>
147:             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${TESTGRID_HOME}</span><span class='def-String'>/</span><span class='def-VarStrong def-Var'>${PRODUCT}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
148:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>deleteDir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
149:             <span class='def-SymbolStrong def-Symbol'>}</span>
150:        <span class='def-SymbolStrong def-Symbol'>}</span>
151:   <span class='def-SymbolStrong def-Symbol'>}</span>
152: <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
153: 
