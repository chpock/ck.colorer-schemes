  0: <span class='def-Comment def-Syntax'>#!</span><span class='def-VarStrong def-Var'>groovy</span>
  1: <span class='def-Keyword'>package</span> build
  2: 
  3: <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>pipeline</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
  4:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>agent</span> <span class='jenkinsfile-Constant def-Constant def-Keyword'>any</span>
  5: 
  6:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>environment</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
  7:         <span class='jenkinsfile-Variable def-Var'>REVISION</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> buildRevisionForBranch<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>./mega-zep-backend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
  8:         <span class='def-LineComment def-Comment def-Syntax'>// POD must have' max_limits * 2' regarding memory</span>
  9:         <span class='jenkinsfile-Variable def-Var'>NODE_RESOURCE_LIMITS</span> <span class='jenkinsfile-Symbol def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>--initial-old-space-size=6144 --max-old-space-size=6144</span><span class='def-StringEdge def-String'>"</span>
 10:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 11: 
 12:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>parameters</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
 13:         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>booleanParam</span><span class='def-SymbolStrong def-Symbol'>(</span>name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>deployToDev</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> defaultValue<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>false</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> description<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>True if the build shall be deployed to dev</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
 14:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 15: 
 16:     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>options</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
 17:         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>disableConcurrentBuilds</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
 18:         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>parallelsAlwaysFailFast</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
 19:     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 20: 
 21:     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stages</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 22:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Lock openshift ressource for parallel</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 23:             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 24:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 25:                     openshift<span class='def-Symbol'>.</span>setLockName<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>openshift-</span><span class='def-VarStrong def-Var'>${env.BUILD_TAG}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 26:                 <span class='def-SymbolStrong def-Symbol'>}</span>
 27:             <span class='def-SymbolStrong def-Symbol'>}</span>
 28:         <span class='def-SymbolStrong def-Symbol'>}</span>
 29:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Build</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 30:             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>parallel</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 31:                 <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>frontend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 32:                     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>agent</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
 33:                         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>kubernetes</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
 34:                             <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>cloud</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>openshift</span><span class='def-StringEdge def-String'>'</span>
 35:                             <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>yamlFile</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>./jenkins/src/build/nodejs-build-pod.yaml</span><span class='def-StringEdge def-String'>"</span>
 36:                         <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 37:                     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
 38:                     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stages</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 39:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Build Artefakt</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 40:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 41:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 42:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>nodejs</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 43:                                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>withCredentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>[</span>file<span class='def-SymbolStrong def-Symbol'>(</span>credentialsId<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>jenkins-mega-cypress</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> variable<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>FILE</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>]</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 44:                                             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-zep-frontend/src/main/angular/frontend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 45:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>cp -f </span><span class='def-VarStrong def-Var'>${FILE}</span><span class='def-String'> ./.env</span><span class='def-StringEdge def-String'>"</span>
 46:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>npm install</span><span class='def-StringEdge def-String'>"</span>
 47:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>node </span><span class='def-VarStrong def-Var'>${NODE_RESOURCE_LIMITS}</span><span class='def-String'> \</span>
 48:                                                     <span class='def-Symbol'>.</span><span class='def-StringEdge def-String'>/</span><span class='def-String'>node_modules</span><span class='def-StringEdge def-String'>/</span><span class='def-Symbol'>@</span>angular<span class='def-Symbol'>/</span>cli<span class='def-Symbol'>/</span>bin<span class='def-Symbol'>/</span>ng \
 49:                                                     test <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>browsers<span class='def-Symbol'>=</span>ChromeHeadlessNoSandbox <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>watch<span class='def-Symbol'>=</span><span class='def-Keyword'>false</span><span class='def-StringEdge def-String'>"</span>
 50:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>node </span><span class='def-VarStrong def-Var'>${NODE_RESOURCE_LIMITS}</span><span class='def-String'> \</span>
 51:                                                     <span class='def-Symbol'>.</span><span class='def-StringEdge def-String'>/</span><span class='def-String'>node_modules</span><span class='def-StringEdge def-String'>/</span><span class='def-Symbol'>@</span>angular<span class='def-Symbol'>/</span>cli<span class='def-Symbol'>/</span>bin<span class='def-Symbol'>/</span>ng build \
 52:                                                     <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>configuration<span class='def-Symbol'>=</span>production<span class='def-StringEdge def-String'>"</span>
 53:                                             <span class='def-SymbolStrong def-Symbol'>}</span>
 54:                                         <span class='def-SymbolStrong def-Symbol'>}</span>
 55:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
 56:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
 57:                             <span class='def-SymbolStrong def-Symbol'>}</span>
 58:                         <span class='def-SymbolStrong def-Symbol'>}</span>
 59:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Cypress Tests</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 60:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 61:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 62:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>nodejs</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 63:                                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-zep-frontend/src/main/angular/frontend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 64:                                             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>npm run e2e-cy</span><span class='def-StringEdge def-String'>"</span>
 65:                                         <span class='def-SymbolStrong def-Symbol'>}</span>
 66:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
 67:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
 68:                             <span class='def-SymbolStrong def-Symbol'>}</span>
 69:                         <span class='def-SymbolStrong def-Symbol'>}</span>
 70:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Build Image</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 71:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 72:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 73:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>nodejs</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 74:                                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-zep-frontend/src/main/angular/frontend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 75:                                             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>lock</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-build-openshift-nodejs</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 76:                                                 openshift<span class='def-Symbol'>.</span>withCluster<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 77:                                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>oc start-build mega-zep-frontend --commit=</span><span class='def-VarStrong def-Var'>${env.GIT_COMMIT}</span><span class='def-String'> \</span>
 78:                                                                                          <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>from<span class='def-Symbol'>-</span>dir<span class='def-Symbol'>=</span>dist<span class='def-Symbol'>/</span>frontend \
 79:                                                                                          <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>follow \
 80:                                                                                          <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>wait<span class='def-StringEdge def-String'>"</span>
 81:                                                     openshift<span class='def-Symbol'>.</span>tag<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-frontend:latest</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-frontend:</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 82:                                                 <span class='def-SymbolStrong def-Symbol'>}</span>
 83:                                             <span class='def-SymbolStrong def-Symbol'>}</span>
 84:                                         <span class='def-SymbolStrong def-Symbol'>}</span>
 85:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
 86:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
 87:                             <span class='def-SymbolStrong def-Symbol'>}</span>
 88:                         <span class='def-SymbolStrong def-Symbol'>}</span>
 89:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Push Image</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 90:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 91:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 92:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>nodejs</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
 93:                                         copyImage<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-frontend:</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
 94:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
 95:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
 96:                             <span class='def-SymbolStrong def-Symbol'>}</span>
 97:                         <span class='def-SymbolStrong def-Symbol'>}</span>
 98:                     <span class='def-SymbolStrong def-Symbol'>}</span>
 99:                 <span class='def-SymbolStrong def-Symbol'>}</span>
100: 
101:                 <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>backend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
102:                     <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>agent</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
103:                         <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>kubernetes</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
104:                             <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>cloud</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>openshift</span><span class='def-StringEdge def-String'>'</span>
105:                             <span class='jenkinsfile-ConfigurationMethod def-StructKeyword def-Keyword'>yamlFile</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>./jenkins/src/build/openjdk-11-build-pod.yaml</span><span class='def-StringEdge def-String'>"</span>
106:                         <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
107:                     <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
108:                     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stages</span> <span class='def-SymbolStrong def-Symbol'>{</span>
109:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Build Artefakt</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
110:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
111:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
112:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>quarkus</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
113:                                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>withCredentials</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>[</span>file<span class='def-SymbolStrong def-Symbol'>(</span>credentialsId<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>jenkins-mega</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> variable<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>FILE</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>]</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
114:                                             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-zep-backend</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
115:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>cp -f </span><span class='def-VarStrong def-Var'>${FILE}</span><span class='def-String'> ./.env</span><span class='def-StringEdge def-String'>"</span>
116:                                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mvn -B -s </span><span class='def-VarStrong def-Var'>${WORKSPACE}</span><span class='def-String'>/jenkins/src/build/jenkins-settings.xml \</span>
117:                                                         clean compile install \
118:                                                         <span class='def-Symbol'>-</span>Drevision<span class='def-Symbol'>=</span>$<span class='def-SymbolStrong def-Symbol'>{</span>env<span class='def-Symbol'>.</span>REVISION<span class='def-SymbolStrong def-Symbol'>}</span> \
119:                                                         <span class='def-Symbol'>-</span>Dgit<span class='def-Symbol'>.</span>commit<span class='def-Symbol'>=</span>$<span class='def-SymbolStrong def-Symbol'>{</span>env<span class='def-Symbol'>.</span>GIT_COMMIT<span class='def-SymbolStrong def-Symbol'>}</span> \
120:                                                         <span class='def-Symbol'>-</span>Dgit<span class='def-Symbol'>.</span>branch<span class='def-Symbol'>=</span>$<span class='def-SymbolStrong def-Symbol'>{</span>env<span class='def-Symbol'>.</span>GIT_BRANCH<span class='def-SymbolStrong def-Symbol'>}</span> \
121:                                                         <span class='def-Symbol'>-</span>Dbuild<span class='def-Symbol'>.</span>number<span class='def-Symbol'>=</span>$<span class='def-SymbolStrong def-Symbol'>{</span>env<span class='def-Symbol'>.</span>BUILD_NUMBER<span class='def-SymbolStrong def-Symbol'>}</span> \
122:                                                         <span class='def-Symbol'>-</span>Dmega<span class='def-Symbol'>.</span>endpoint<span class='def-Symbol'>.</span>test<span class='def-Symbol'>.</span>enable<span class='def-Symbol'>=</span><span class='def-Keyword'>false</span><span class='def-StringEdge def-String'>"</span>
123:                                                 jacoco<span class='def-SymbolStrong def-Symbol'>(</span>execPattern<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>target/*.exec</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span>
124:                                                         classPattern<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>target/classes</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span>
125:                                                         sourcePattern<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>src/main/java</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span>
126:                                                         sourceExclusionPattern<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>src/test/java</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span>
127:                                                         exclusionPattern<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>**/provantis/**,**/AutoValue_*</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span>
128:                                             <span class='def-SymbolStrong def-Symbol'>}</span>
129:                                         <span class='def-SymbolStrong def-Symbol'>}</span>
130:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
131:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
132:                             <span class='def-SymbolStrong def-Symbol'>}</span>
133:                         <span class='def-SymbolStrong def-Symbol'>}</span>
134:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Build Image</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
135:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
136:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
137:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>quarkus</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
138:                                         <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>dir</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-zep-backend/target/</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
139:                                             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>lock</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-build-openshift-quarkus</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
140:                                                 openshift<span class='def-Symbol'>.</span>withCluster<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
141:                                                     <span class='def-Keyword'>def</span> artifact <span class='def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-backend-</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-String'>-runner.jar</span><span class='def-StringEdge def-String'>"</span>
142:                                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>sh</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>oc start-build mega-zep-backend --from-file=</span><span class='def-VarStrong def-Var'>${artifact}</span><span class='def-String'> --follow --wait</span><span class='def-StringEdge def-String'>"</span>
143:                                                     openshift<span class='def-Symbol'>.</span>tag<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-backend:latest</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-backend:</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
144:                                                 <span class='def-SymbolStrong def-Symbol'>}</span>
145:                                             <span class='def-SymbolStrong def-Symbol'>}</span>
146:                                         <span class='def-SymbolStrong def-Symbol'>}</span>
147:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
148:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
149:                             <span class='def-SymbolStrong def-Symbol'>}</span>
150:                         <span class='def-SymbolStrong def-Symbol'>}</span>
151:                         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Push Image</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
152:                             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
153:                                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
154:                                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>container</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>quarkus</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
155:                                         copyImage<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>mega-zep-backend:</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
156:                                     <span class='def-SymbolStrong def-Symbol'>}</span>
157:                                 <span class='def-SymbolStrong def-Symbol'>}</span>
158:                             <span class='def-SymbolStrong def-Symbol'>}</span>
159:                         <span class='def-SymbolStrong def-Symbol'>}</span>
160:                     <span class='def-SymbolStrong def-Symbol'>}</span>
161:                 <span class='def-SymbolStrong def-Symbol'>}</span>
162:             <span class='def-SymbolStrong def-Symbol'>}</span>
163:         <span class='def-SymbolStrong def-Symbol'>}</span>
164: 
165:         <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>stage</span><span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>Deploy DEV</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
166:             <span class='jenkinsfile-ConditionMethod def-InterfaceKeyword def-Keyword'>when</span> <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>{</span>
167:                 <span class='jenkinsfile-ConditionMethod def-InterfaceKeyword def-Keyword'>expression</span> <span class='def-SymbolStrong def-Symbol'>{</span>
168:                     <span class='def-Keyword'>return</span> params<span class='def-Symbol'>.</span>deployToDev
169:                 <span class='def-SymbolStrong def-Symbol'>}</span>
170:             <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
171:             <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>steps</span> <span class='def-SymbolStrong def-Symbol'>{</span>
172:                 <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
173:                     <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>build</span> job<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>mega-release</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> parameters<span class='def-Symbol'>:</span> <span class='def-SymbolStrong def-Symbol'>[</span>
174:                             string<span class='def-SymbolStrong def-Symbol'>(</span>name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>Branch</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> value<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>master</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-Symbol'>,</span>
175:                             string<span class='def-SymbolStrong def-Symbol'>(</span>name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>target</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> value<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>dev</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-Symbol'>,</span>
176:                             string<span class='def-SymbolStrong def-Symbol'>(</span>name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>stage</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> value<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>default</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-Symbol'>,</span>
177:                             string<span class='def-SymbolStrong def-Symbol'>(</span>name<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>version</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> value<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${env.REVISION}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>]</span>
178:                 <span class='def-SymbolStrong def-Symbol'>}</span>
179:             <span class='def-SymbolStrong def-Symbol'>}</span>
180:         <span class='def-SymbolStrong def-Symbol'>}</span>
181:     <span class='def-SymbolStrong def-Symbol'>}</span>
182: 
183:     <span class='jenkinsfile-MainMethod def-ClassKeyword def-Keyword'>post</span> <span class='def-SymbolStrong def-Symbol'>{</span>
184:         <span class='jenkinsfile-ConditionMethod def-InterfaceKeyword def-Keyword'>failure</span> <span class='def-SymbolStrong def-Symbol'>{</span>
185:             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
186:                 emailext attachLog<span class='def-Symbol'>:</span> <span class='def-Keyword'>true</span><span class='def-Symbol'>,</span>
187:                         recipientProviders<span class='def-Symbol'>:</span> <span class='def-SymbolStrong def-Symbol'>[</span>
188:                                 <span class='def-SymbolStrong def-Symbol'>[</span><span class='jenkinsfile-Constant def-Constant def-Keyword'>$class</span><span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>DevelopersRecipientProvider</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>]</span><span class='def-Symbol'>,</span>
189:                                 <span class='def-SymbolStrong def-Symbol'>[</span><span class='jenkinsfile-Constant def-Constant def-Keyword'>$class</span><span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>RequesterRecipientProvider</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>]</span>
190:                         <span class='def-SymbolStrong def-Symbol'>]</span><span class='def-Symbol'>,</span>
191:                         subject<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>MEGA Jenkions Job </span><span class='def-VarStrong def-Var'>${env.JOB_NAME}</span><span class='def-String'>#</span><span class='def-VarStrong def-Var'>${env.BUILD_NUMBER}</span><span class='def-String'> failed</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span>
192:                         body<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
193: <span class='def-String'>Build for Branch '</span><span class='def-VarStrong def-Var'>${env.GIT_BRANCH}</span><span class='def-String'>@</span><span class='def-VarStrong def-Var'>${env.GIT_COMMIT}</span><span class='def-String'>' has failed.</span>
194: <span class='def-String'></span>
195: <span class='def-String'>Please see </span><span class='def-VarStrong def-Var'>${env.RUN_DISPLAY_URL}</span><span class='def-String'> for further details</span>
196: <span class='def-StringEdge def-String'>"""</span>
197:             <span class='def-SymbolStrong def-Symbol'>}</span>
198:         <span class='def-SymbolStrong def-Symbol'>}</span>
199: 
200:         <span class='jenkinsfile-ConditionMethod def-InterfaceKeyword def-Keyword'>fixed</span> <span class='def-SymbolStrong def-Symbol'>{</span>
201:             <span class='jenkinsfile-OtherMethod def-FunctionKeyword def-Keyword'>script</span> <span class='def-SymbolStrong def-Symbol'>{</span>
202:                 emailext attachLog<span class='def-Symbol'>:</span> <span class='def-Keyword'>true</span><span class='def-Symbol'>,</span>
203:                         recipientProviders<span class='def-Symbol'>:</span> <span class='def-SymbolStrong def-Symbol'>[</span>
204:                                 <span class='def-SymbolStrong def-Symbol'>[</span><span class='jenkinsfile-Constant def-Constant def-Keyword'>$class</span><span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>DevelopersRecipientProvider</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>]</span><span class='def-Symbol'>,</span>
205:                                 <span class='def-SymbolStrong def-Symbol'>[</span><span class='jenkinsfile-Constant def-Constant def-Keyword'>$class</span><span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>RequesterRecipientProvider</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>]</span>
206:                         <span class='def-SymbolStrong def-Symbol'>]</span><span class='def-Symbol'>,</span>
207:                         subject<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>MEGA Jenkions Job </span><span class='def-VarStrong def-Var'>${env.JOB_NAME}</span><span class='def-String'>#</span><span class='def-VarStrong def-Var'>${env.BUILD_NUMBER}</span><span class='def-String'> fixed</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span>
208:                         body<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>"""</span><span class='def-String'></span>
209: <span class='def-String'>Build for Branch '</span><span class='def-VarStrong def-Var'>${env.GIT_BRANCH}</span><span class='def-String'>@</span><span class='def-VarStrong def-Var'>${env.GIT_COMMIT}</span><span class='def-String'>' has been fixed.</span>
210: <span class='def-StringEdge def-String'>"""</span>
211:             <span class='def-SymbolStrong def-Symbol'>}</span>
212:         <span class='def-SymbolStrong def-Symbol'>}</span>
213:     <span class='def-SymbolStrong def-Symbol'>}</span>
214: <span class='jenkinsfile-SymbolStrong def-SymbolStrong def-Symbol'>}</span>
215: 
216: <span class='def-Keyword'>def</span> copyImage<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-FunctionKeyword def-Keyword'>String</span> sourceImageTag<span class='def-Symbol'>,</span> <span class='def-FunctionKeyword def-Keyword'>String</span> targetImageTag <span class='def-Symbol'>=</span> sourceImageTag<span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
217:     withCredentials<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>[</span>usernamePassword<span class='def-SymbolStrong def-Symbol'>(</span>credentialsId<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>dockerhub</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> usernameVariable<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>USERNAME</span><span class='def-StringEdge def-String'>'</span><span class='def-Symbol'>,</span> passwordVariable<span class='def-Symbol'>:</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>PASSWORD</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>]</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
218:         sh <span class='def-StringEdge def-String'>"</span><span class='def-String'>skopeo copy --src-tls-verify=false \</span>
219:                     <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>dest<span class='def-Symbol'>-</span>tls<span class='def-Symbol'>-</span>verify<span class='def-Symbol'>=</span><span class='def-Keyword'>false</span> \
220:                     <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>src<span class='def-Symbol'>-</span>creds openshift<span class='def-Symbol'>:</span>\$<span class='def-SymbolStrong def-Symbol'>(</span>oc whoami <span class='def-Symbol'>-</span>t<span class='def-SymbolStrong def-Symbol'>)</span> \
221:                     <span class='def-Symbol'>-</span><span class='def-Symbol'>-</span>dest<span class='def-Symbol'>-</span>creds<span class='def-Symbol'>=</span>$<span class='def-SymbolStrong def-Symbol'>{</span>USERNAME<span class='def-SymbolStrong def-Symbol'>}</span><span class='def-Symbol'>:</span>$<span class='def-SymbolStrong def-Symbol'>{</span>PASSWORD<span class='def-SymbolStrong def-Symbol'>}</span> \
222:                     docker<span class='def-Symbol'>:</span><span class='def-LineComment def-Comment def-Syntax'>//docker-registry.default.svc:5000/57-mega-dev/${sourceImageTag} \</span>
223:                     docker<span class='def-Symbol'>:</span><span class='def-LineComment def-Comment def-Syntax'>//registry.hub.docker.com/${USERNAME}/${targetImageTag}"</span>
224:     <span class='def-SymbolStrong def-Symbol'>}</span>
225: <span class='def-SymbolStrong def-Symbol'>}</span>
226: 
227: <span class='def-Keyword'>def</span> buildRevisionForBranch<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-FunctionKeyword def-Keyword'>String</span> pomLocation <span class='def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>.</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
228:     <span class='def-FunctionKeyword def-Keyword'>String</span> branch <span class='def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-VarStrong def-Var'>${env.GIT_BRANCH}</span><span class='def-StringEdge def-String'>"</span>
229:     <span class='def-Keyword'>if</span> <span class='def-SymbolStrong def-Symbol'>(</span>branch <span class='def-Symbol'>=</span><span class='def-Symbol'>=</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>develop</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
230:         pom <span class='def-Symbol'>=</span> readMavenPom file<span class='def-Symbol'>:</span> pomLocation <span class='def-Symbol'>+</span> <span class='def-StringEdge def-String'>'</span><span class='def-String'>/pom.xml</span><span class='def-StringEdge def-String'>'</span>
231:         <span class='def-Keyword'>return</span> pom<span class='def-Symbol'>.</span>properties<span class='def-SymbolStrong def-Symbol'>[</span><span class='def-StringEdge def-String'>'</span><span class='def-String'>revision</span><span class='def-StringEdge def-String'>'</span><span class='def-SymbolStrong def-Symbol'>]</span>
232:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='def-Keyword'>else</span> <span class='def-Keyword'>if</span> <span class='def-SymbolStrong def-Symbol'>(</span>branch<span class='def-Symbol'>.</span>startsWith<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>feature/</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
233:         <span class='def-Keyword'>return</span> branch<span class='def-Symbol'>.</span>replace<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>/</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> <span class='def-StringEdge def-String'>"</span><span class='def-String'>-</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-Symbol'>.</span>toUpperCase<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-SymbolStrong def-Symbol'>)</span>
234:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='def-Keyword'>else</span> <span class='def-Keyword'>if</span> <span class='def-SymbolStrong def-Symbol'>(</span>branch<span class='def-Symbol'>.</span>startsWith<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>release/</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-Symbol'>|</span><span class='def-Symbol'>|</span> branch<span class='def-Symbol'>.</span>startsWith<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>hotfix/</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-SymbolStrong def-Symbol'>)</span> <span class='def-SymbolStrong def-Symbol'>{</span>
235:         <span class='def-Keyword'>return</span> branch<span class='def-Symbol'>.</span>replace<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>release/</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> <span class='def-StringEdge def-String'>"</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span><span class='def-Symbol'>.</span>replace<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>hotfix/</span><span class='def-StringEdge def-String'>"</span><span class='def-Symbol'>,</span> <span class='def-StringEdge def-String'>"</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
236:     <span class='def-SymbolStrong def-Symbol'>}</span> <span class='def-Keyword'>else</span> <span class='def-SymbolStrong def-Symbol'>{</span>
237:         error<span class='def-SymbolStrong def-Symbol'>(</span><span class='def-StringEdge def-String'>"</span><span class='def-String'>Cannot caluclate version for branch=</span><span class='def-VarStrong def-Var'>${branch}</span><span class='def-StringEdge def-String'>"</span><span class='def-SymbolStrong def-Symbol'>)</span>
238:     <span class='def-SymbolStrong def-Symbol'>}</span>
239: <span class='def-SymbolStrong def-Symbol'>}</span>
240: 
